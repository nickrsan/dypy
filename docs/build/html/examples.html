

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DyPy Examples &mdash; DyPy 0.0.3b documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DyPy API" href="api.html" />
    <link rel="prev" title="DyPy Core Concepts and Classes" href="conceptual_overview.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> DyPy
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="conceptual_overview.html">DyPy Core Concepts and Classes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DyPy Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#programming-effort">Programming Effort</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#solution">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">DyPy API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DyPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>DyPy Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dypy-examples">
<h1>DyPy Examples<a class="headerlink" href="#dypy-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="programming-effort">
<h2>Programming Effort<a class="headerlink" href="#programming-effort" title="Permalink to this headline">¶</a></h2>
<p>You’re a programmer working hard to triage bugs in your software
before a big release coming up. In your bug tracker, bugs are split
into 5 categories: “Core”, “UX/UI”, “Network”, “Database”, and “API”.
The release is in 12 days, but your team manager wants to make sure
to get some fixes in each, so they ask you to spend no more
than 5 days on any single area and at least one day on each, but other than that, they just want you
to fix the most bugs possible. Often, you get some benefit from continued work
on one area, so you fix more bugs the longer the time you spend on one task,
but you also know some areas a bit better than others and burn out a bit if
you spend too much time in any one area. Based on that, and the prioritization
of tickets in the tracker, you estimate the number
of bugs you fix in each category as a function of time as follows:</p>
<table border="1" class="colwidths-given docutils" id="id1">
<caption><span class="caption-text">Bugs closed by days of effort in each area</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="40%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">1 Day</th>
<th class="head">2 Days</th>
<th class="head">3 Days</th>
<th class="head">4 Days</th>
<th class="head">5 Days</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Core</td>
<td>2</td>
<td>5</td>
<td>7</td>
<td>8</td>
<td>10</td>
</tr>
<tr class="row-odd"><td>UI/UX</td>
<td>3</td>
<td>6</td>
<td>8</td>
<td>9</td>
<td>9</td>
</tr>
<tr class="row-even"><td>Network</td>
<td>1</td>
<td>2</td>
<td>4</td>
<td>7</td>
<td>9</td>
</tr>
<tr class="row-odd"><td>Database</td>
<td>2</td>
<td>3</td>
<td>6</td>
<td>8</td>
<td>11</td>
</tr>
<tr class="row-even"><td>API</td>
<td>4</td>
<td>6</td>
<td>8</td>
<td>9</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Build a dynamic program that recommends the appropriate days of effort for each category.</p>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<p>Using DyPy, we’ll set up each category of work as a stage since we’ll do them sequentially,
and then build an objective function that provides the number of bugs closed for a given
number of days of effort.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have 12 days available to us for work</span>
<span class="n">state_variable</span> <span class="o">=</span> <span class="n">dypy</span><span class="o">.</span><span class="n">StateVariable</span><span class="p">(</span><span class="s2">&quot;Days Spent On Category&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="c1"># but we can only spend between 1 and 5 days sworking on a single category</span>
<span class="n">decision_variable</span> <span class="o">=</span> <span class="n">dypy</span><span class="o">.</span><span class="n">DecisionVariable</span><span class="p">(</span><span class="s2">&quot;Time on Category&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">stage</span><span class="p">,</span> <span class="n">days_spent_on_category</span><span class="p">,</span> <span class="n">time_on_category</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        When the objective is called, the solver makes the stage, state variables,</span>
<span class="sd">        and decision variable available to it. The keyword argument names here</span>
<span class="sd">        match the names of the state variables and decision variables (which will be</span>
<span class="sd">        passed as keyword arguments, so order isn&#39;t important, but name is). The name</span>
<span class="sd">        is automatically derived by lowercasing the name of the variable and replacing</span>
<span class="sd">        spaces with underscores. It will remove digits from the front if they are present</span>
<span class="sd">        so that the name is a valid python identifier. You can also manually provide a</span>
<span class="sd">        kwarg name - if you wish to do this, see the API documentation.</span>

<span class="sd">        In this example, we can think of these variables as providing:</span>
<span class="sd">            1. stage - this will give access to the DyPy.stage object</span>
<span class="sd">            2. state - this just provides access to the state value being assessed, not the object</span>
<span class="sd">            3. decision - this just provides access to the decision value being assessed, not the object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># we are given benefits, so defining here - each category is a row, each column is</span>
    <span class="c1"># number of days, and the value is how much benefit we get from working on that category</span>
    <span class="c1"># for that long</span>
    <span class="n">benefit_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># column 0 means no time spent on it, so we get no benefit</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">time_on_category</span> <span class="o">&gt;</span> <span class="n">days_spent_on_category</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">stage</span><span class="o">.</span><span class="n">parent_dp</span><span class="o">.</span><span class="n">exclusion_value</span>  <span class="c1">#</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">benefit_list</span><span class="p">[</span><span class="n">stage</span><span class="o">.</span><span class="n">number</span><span class="p">][</span><span class="n">time_on_category</span><span class="p">]</span>

<span class="c1"># define the dynamic program and tell it we have four timesteps</span>
<span class="n">dynamic_program</span> <span class="o">=</span> <span class="n">dypy</span><span class="o">.</span><span class="n">DynamicProgram</span><span class="p">(</span><span class="n">timestep_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                      <span class="n">objective_function</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">calculation_function</span><span class="o">=</span><span class="n">dypy</span><span class="o">.</span><span class="n">MAXIMIZE</span><span class="p">,</span>
                                      <span class="n">prior</span><span class="o">=</span><span class="n">dypy</span><span class="o">.</span><span class="n">SimplePrior</span><span class="p">)</span>
<span class="n">dynamic_program</span><span class="o">.</span><span class="n">exclusion_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># set it to -1 since we know nothing else will be negative here - lets us visualize arrays better</span>
<span class="n">dynamic_program</span><span class="o">.</span><span class="n">decision_variable</span> <span class="o">=</span> <span class="n">decision_variable</span>
<span class="n">dynamic_program</span><span class="o">.</span><span class="n">add_state_variable</span><span class="p">(</span><span class="n">state_variable</span><span class="p">)</span>

<span class="c1"># each category will be a stage, in effect - tell it to create all five stages as empty</span>
<span class="n">dynamic_program</span><span class="o">.</span><span class="n">build_stages</span><span class="p">(</span><span class="n">name_prefix</span><span class="o">=</span><span class="s2">&quot;Category&quot;</span><span class="p">)</span>  <span class="c1"># assigns names by default, but we can override them</span>
<span class="n">stage_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Core&quot;</span><span class="p">,</span> <span class="s2">&quot;UI/UX&quot;</span><span class="p">,</span> <span class="s2">&quot;Network&quot;</span><span class="p">,</span> <span class="s2">&quot;Database&quot;</span><span class="p">,</span> <span class="s2">&quot;API&quot;</span><span class="p">]</span>  <span class="c1"># make a list of names in the same order they&#39;re used in our objective function</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">stage</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dynamic_program</span><span class="o">.</span><span class="n">stages</span><span class="p">):</span>  <span class="c1"># and use it to set the value of .name for each stage</span>
    <span class="n">dynamic_program</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">stage_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">dynamic_program</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="c1"># run the dynamic program - results are logged to python logger `dypy` and decisions are set on each stage as .decision_amount</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="DyPy API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="conceptual_overview.html" class="btn btn-neutral" title="DyPy Core Concepts and Classes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Nick Santos

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>